## 2024-05-23 - Buffer Overflow Prevention in Legacy C++
**Vulnerability:** Detected multiple usages of `sprintf` with small stack-allocated buffers (e.g., `char temp[5]`) for formatting integers. Large values could overflow these buffers, corrupting the stack.
**Learning:** Legacy C++ codebases often rely on `sprintf` for string formatting without bounds checking. In high-performance loops or logic (like Lua interface bindings), these small buffers are common optimization attempts but pose significant security risks.
**Prevention:** Systematically replace `sprintf` with `snprintf`, passing `sizeof(buffer)` as the size argument. This ensures that even if the data exceeds the buffer size, it will be truncated rather than causing an overflow. Verify buffer sizes are adequate for expected data, but rely on `snprintf` for safety.
